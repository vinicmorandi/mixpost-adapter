import{n as b,W as B,H as F,r as A,o,c as v,e as y,j as E,k as _,w as t,a as e,b as a,a7 as P,ab as Z,h as m,t as i,f as w,a8 as z,ac as j,c5 as O,A as G,c8 as K,ae as Q,O as X,d as Y,S as ee,a0 as te,a5 as se,a6 as N,l as I,F as R,Z as ae,q as le,_ as re,au as T,a2 as oe,J as ne}from"./app.a05b4c5c.js";import{_ as ie}from"./Admin.7fa4ba78.js";import{u as ue}from"./useSelectable.08fa8b7e.js";import{_ as ce}from"./PageHeader.044c6731.js";import{_ as me}from"./PureDangerButton.9adab555.js";import{_ as de}from"./Panel.05e9bba5.js";import{_ as q}from"./Checkbox.12b1be22.js";import{_ as n,a as L,T as fe}from"./TableCell.8aafd44e.js";import{_ as _e}from"./PureButtonLink.21473f96.js";import{E as pe}from"./Eye.bdca2e42.js";import{T as H}from"./Trash.83ab4124.js";import{_ as he}from"./DropdownButton.8d634dd9.js";import{_ as $e}from"./SelectableBar.c8863131.js";import{_ as ve}from"./NoResult.b8d4ef7e.js";import{_ as ke}from"./Pagination.cc249589.js";import{_ as ge}from"./SearchInput.296daeed.js";import{_ as be}from"./Flex.513e8e8d.js";import"./PureButton.7cf07808.js";import"./EllipsisVertical.0bda3946.js";import"./ChevronLeft.727e7cc4.js";import"./Input.44809a08.js";const ye={class:"flex flex-row items-center justify-end gap-xs"},we={__name:"UserItemAction",props:{itemId:{type:Number,required:!0}},emits:["onDelete"],setup(s,{emit:d}){const l=s,u=b("routePrefix"),p=b("confirmation"),{user:x}=B(),V=F(!1),k=()=>{p().title($t("user.delete_user")).description($t("user.confirm_delete_user")).destructive().onConfirm(r=>{r.isLoading(!0),j.delete(route(`${u}.users.delete`,{user:l.itemId}),{onSuccess(){V.value=!1,d("onDelete"),O.emit("userDelete",l.itemId),r.reset()},onFinish(){r.close()}})}).show()};return(r,D)=>{const $=A("tooltip");return o(),v("div",null,[y("div",ye,[E((o(),_(_e,{href:r.route(`${a(u)}.users.view`,{user:s.itemId})},{default:t(()=>[e(pe)]),_:1},8,["href"])),[[$,r.$t("general.view")]]),e(z,{"width-classes":"w-32",placement:"bottom-end"},{trigger:t(()=>[e(he)]),content:t(()=>[e(P,{href:r.route(`${a(u)}.users.edit`,{user:s.itemId})},{default:t(()=>[e(Z,{class:"mr-xs"}),m(" "+i(r.$t("general.edit")),1)]),_:1},8,["href"]),a(x).id!==s.itemId?(o(),_(P,{key:0,onClick:k,as:"button"},{default:t(()=>[e(H,{class:"text-red-500 mr-xs"}),m(" "+i(r.$t("general.delete")),1)]),_:1})):w("",!0)]),_:1})])])}}},xe={__name:"UserItem",props:{item:{type:Object,required:!0}},setup(s){return(d,l)=>(o(),_(L,{hoverable:!0},{default:t(()=>[e(n,{class:"w-10"},{default:t(()=>[G(d.$slots,"checkbox")]),_:3}),e(n,null,{default:t(()=>[e(K,{name:s.item.name},null,8,["name"])]),_:1}),e(n,null,{default:t(()=>[y("div",null,i(s.item.name),1),s.item.is_admin?(o(),_(Q,{key:0,class:"mt-xs"},{default:t(()=>[m(i(d.$t("user.system_admin")),1)]),_:1})):w("",!0)]),_:1}),e(n,null,{default:t(()=>[m(i(s.item.email),1)]),_:1}),e(n,null,{default:t(()=>[m(i(s.item.created_at),1)]),_:1}),e(n,null,{default:t(()=>[e(we,{itemId:s.item.id},null,8,["itemId"])]),_:1})]),_:3}))}},Ve={class:"flex items-center"},De={__name:"Filters",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(s,{emit:d}){return X(()=>0),(l,u)=>(o(),v("div",Ve,[e(ge,{modelValue:s.modelValue.keyword,"onUpdate:modelValue":u[0]||(u[0]=p=>s.modelValue.keyword=p),placeholder:l.$t("general.search")},null,8,["modelValue","placeholder"])]))}},Ie={class:"w-full mx-auto max-w-6xl row-py"},je={class:"mt-lg row-px w-full"},Oe={key:0,class:"mt-lg"},Se=Y({layout:ie}),Xe=Object.assign(Se,{__name:"Users",props:{users:{type:Object},filter:{type:Object,default:{}}},setup(s){const d=s,{t:l}=ee(),u=b("routePrefix"),p=l("user.users"),{notify:x}=ne(),V=b("confirmation"),{user:k}=B(),{selectedRecords:r,putPageRecords:D,toggleSelectRecordsOnPage:$,deselectRecord:S,deselectAllRecords:U}=ue(),C=()=>d.users.data.filter(c=>c.id!==k.value.id).map(c=>c.id),g=F({keyword:d.filter.keyword});te(()=>{D(C()),O.on("userDelete",c=>{S(c)})}),se(()=>{O.off("userDelete")}),N(()=>d.users.data,()=>{D(C())}),N(()=>I.exports.cloneDeep(g.value),I.exports.throttle(()=>{j.get(route(`${u}.users.index`),I.exports.pickBy(g.value),{preserveState:!0,only:["users","filter"]})},300));const J=()=>{V().title(l("user.delete_users")).description(l("user.confirm_delete_users")).destructive().onConfirm(c=>{c.isLoading(!0),j.delete(route(`${u}.users.multipleDelete`),{data:{users:r.value},preserveScroll:!0,onSuccess(){U(),x("success",l("user.selected_users_deleted"))},onFinish(){c.reset()}})}).show()};return(c,h)=>{const M=A("tooltip");return o(),v(R,null,[e(a(ae),{title:a(p)},null,8,["title"]),y("div",Ie,[e(ce,{title:a(p)},{description:t(()=>[m(i(a(l)("user.manage_users")),1)]),_:1},8,["title"]),y("div",je,[e($e,{count:a(r).length,onClose:a(U)},{default:t(()=>[E((o(),_(me,{onClick:J},{default:t(()=>[e(H)]),_:1})),[[M,a(l)("general.delete")]])]),_:1},8,["count","onClose"]),e(be,{class:"justify-between"},{default:t(()=>[e(a(le),{href:c.route(`${a(u)}.users.create`),class:"mb-xs sm:mb-0"},{default:t(()=>[e(re,null,{default:t(()=>[m(i(a(l)("user.create_user")),1)]),_:1})]),_:1},8,["href"]),e(De,{modelValue:g.value,"onUpdate:modelValue":h[0]||(h[0]=f=>g.value=f)},null,8,["modelValue"])]),_:1}),e(de,{"with-padding":!1,class:"mt-lg"},{default:t(()=>[e(fe,null,{head:t(()=>[e(L,null,{default:t(()=>[e(n,{component:"th",scope:"col",class:"w-10"},{default:t(()=>[e(q,{checked:a($),"onUpdate:checked":h[1]||(h[1]=f=>T($)?$.value=f:null),disabled:!s.users.meta.total},null,8,["checked","disabled"])]),_:1}),e(n,{component:"th",scope:"col"}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(a(l)("general.name")),1)]),_:1}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(a(l)("general.email")),1)]),_:1}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(a(l)("general.created_at")),1)]),_:1}),e(n,{component:"th",scope:"col"})]),_:1})]),body:t(()=>[(o(!0),v(R,null,oe(s.users.data,f=>(o(),_(xe,{key:f.id,item:f,onOnDelete:()=>{a(S)(f.id)}},{checkbox:t(()=>[e(q,{checked:a(r),"onUpdate:checked":h[2]||(h[2]=W=>T(r)?r.value=W:null),value:f.id,disabled:f.id===a(k).id,number:""},null,8,["checked","value","disabled"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),s.users.meta.total?w("",!0):(o(),_(ve,{key:0,table:""}))]),_:1}),s.users.meta.links.length>3?(o(),v("div",Oe,[e(ke,{meta:s.users.meta,links:s.users.links},null,8,["meta","links"])])):w("",!0)])])],64)}}});export{Xe as default};
