import{S as U,l as L,H as z,T as G,O as H,c as $,a,b as e,e as m,w as s,g as J,_ as g,k as w,f as k,F as C,N as y,ac as T,o as n,Z as M,h as u,t as x,i as Z,q as K,m as Q,a2 as R,bq as W,n as X,J as Y}from"./app.a05b4c5c.js";import{u as ee}from"./usePostVersions.2acb12a0.js";import{u as te}from"./Variable.40ae6e15.js";import{u as ae}from"./useTemplate.b5458e5b.js";import{_ as se}from"./PageHeader.044c6731.js";import{_ as oe}from"./Panel.05e9bba5.js";import{_ as re}from"./Input.44809a08.js";import{V as le,_ as ie}from"./LabelSuffix.20800baf.js";import{_ as me,a as ne,b as pe,c as de,d as ue,e as ce}from"./VariableManager.81676a1a.js";import{T as fe}from"./Trash.83ab4124.js";import"./index.a09b91eb.js";import"./Flex.513e8e8d.js";import"./index.46705d6a.js";import"./vue.runtime.esm-bundler.1eff9dea.js";import"./MediaGifs.adeff4b7.js";import"./index.browser.8e74d592.js";import"./Masonry.cd3ab109.js";import"./MediaFile.a2421f6b.js";import"./ExclamationCircle.df2493b4.js";import"./SearchInput.296daeed.js";import"./NoResult.b8d4ef7e.js";import"./Alert.49de0ead.js";import"./Tab.af6a2b17.js";import"./PureButton.7cf07808.js";import"./EllipsisVertical.0bda3946.js";import"./ListItem.6e08e2e8.js";import"./Textarea.8d64ff10.js";const _e={class:"w-full max-w-5xl mx-auto row-py"},xe={class:"flex"},ve={class:"mt-lg row-px w-full"},be=["onSubmit"],we={for:"template_name"},ke={class:"relative flex items-center justify-between border-t border-gray-200 pt-md mt-md"},ye={class:"flex items-center space-x-xs"},$e={class:"mt-md flex items-center"},Re={__name:"CreateEdit",props:["template"],setup(h){const p=h,{t:o}=U(),l=p.template?L.exports.cloneDeep(p.template):null;W("postCtx",{});const c=X("workspaceCtx"),{notify:v}=Y(),{versionContentObject:S}=ee(),{insertEmoji:j,insertContent:V,focusEditor:B}=te(),{createPost:q,formatTemplateContent:A,deleteTemplate:D}=ae(),d=z(!1),f=G({name:l?l.name:"",content:l?l.content:[S()]}),E=H(()=>p.template?o("template.edit_template"):o("template.create_new_template")),b=()=>({name:f.name,content:A(f.content)}),F=()=>{p.template||I(b()),p.template&&O(b())},I=(_,t=!1)=>{y.start(),d.value=!0,axios.post(route("mixpost.templates.api.store",{workspace:c.id}),_).then(r=>{if(v("success",o("template.template_created")),!t){T.get(route("mixpost.templates.edit",{workspace:c.id,template:r.data.id}),{},{preserveScroll:!0});return}T.get(route("mixpost.templates.create",{workspace:c.id}))}).finally(()=>{y.done(),d.value=!1})},O=_=>{y.start(),d.value=!0,axios.put(route("mixpost.templates.api.update",{workspace:c.id,template:p.template.id}),_).then(()=>{v("success",o("template.template_updated"))}).catch(t=>{if(t.response.status!==422){v("error",t.response.data.message);return}v("error",o("template.error_saving_template"))}).finally(()=>{y.done(),d.value=!1})};return(_,t)=>(n(),$(C,null,[a(e(M),{title:e(E)},null,8,["title"]),m("div",_e,[a(se,{title:e(E)},{default:s(()=>[m("div",xe,[e(l)?(n(),w(g,{key:0,onClick:t[0]||(t[0]=()=>{e(q)(b().content)}),class:"mr-xs"},{default:s(()=>[u(x(e(o)("template.use_template")),1)]),_:1})):k("",!0),e(l)?(n(),w(e(K),{key:1,href:_.route("mixpost.templates.create",{workspace:e(c).id})},{default:s(()=>[a(Z,{class:"mr-xs"},{default:s(()=>[u(x(e(o)("template.create_new")),1)]),_:1})]),_:1},8,["href"])):k("",!0),e(l)?(n(),w(Q,{key:2,onClick:t[1]||(t[1]=()=>{e(D)(e(l))}),size:"sm"},{default:s(()=>[a(fe)]),_:1})):k("",!0)])]),_:1},8,["title"]),m("div",ve,[m("form",{onSubmit:J(F,["prevent"])},[a(oe,null,{default:s(()=>[a(le,{class:"mb-md"},{title:s(()=>[m("label",we,[u(x(e(o)("template.template_name"))+" ",1),a(ie,{danger:!0},{default:s(()=>[u("*")]),_:1})])]),default:s(()=>[a(re,{type:"text",modelValue:e(f).name,"onUpdate:modelValue":t[2]||(t[2]=r=>e(f).name=r),id:"template_name",required:""},null,8,["modelValue"])]),_:1}),(n(!0),$(C,null,R(e(f).content,(r,P)=>(n(),$(C,{key:P},[a(me,{id:"templateEditor",value:r.body,editable:!0,onUpdate:N=>r.body=N,placeholder:e(o)("post.type_something")},{default:s(N=>[m("div",ke,[m("div",ye,[a(ne,{onSelected:t[3]||(t[3]=i=>e(j)({editorId:"templateEditor",emoji:i})),onClose:t[4]||(t[4]=i=>e(B)({editorId:"templateEditor"}))}),a(pe,{onInsert:i=>r.media=[...r.media,...i],selectedAccounts:[],activeVersion:0,versions:[],media:r.media},null,8,["onInsert","media"]),a(de,{editAllowed:!0,onInsert:t[5]||(t[5]=i=>e(V)({editorId:"templateEditor",text:i}))}),a(ue,{editAllowed:!0,onInsert:t[6]||(t[6]=i=>e(V)({editorId:"templateEditor",text:i}))})])])]),_:2},1032,["value","onUpdate","placeholder"]),a(ce,{media:r.media},null,8,["media"])],64))),128))]),_:1}),m("div",$e,[a(g,{disabled:d.value,type:"submit",class:"mr-xs"},{default:s(()=>[u(x(e(o)("template.save_template")),1)]),_:1},8,["disabled"]),e(l)?k("",!0):(n(),w(g,{key:0,onClick:t[7]||(t[7]=()=>{I(b(),!0)}),disabled:d.value,type:"button"},{default:s(()=>[u(x(e(o)("template.save_create_new")),1)]),_:1},8,["disabled"]))])],40,be)])])],64))}};export{Re as default};
